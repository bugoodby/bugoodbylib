<!DOCTYPE html>
<html lang="ja">
<head>
	<meta http-equiv="Content-Style-Type" content="text/css" /> 
	<meta http-equiv="Content-Script-Type" content="text/javascript" /> 
	<meta http-equiv="Content-Type" content="text/html; charset=shift_jis" /> 
	<title>DefineConverter</title> 
	<style>
html,body {
	height: 100%;
	width: 100%;
	margin: 0;
	padding: 0;
	border: 0 none;
}
html {
	overflow-y: scroll;
}
body {
	background-color: #e0e0e0;
	font: normal 12px "メイリオ", Meiryo, "ヒラギノ角ゴ Pro W3", "Hiragino Kaku Gothic Pro", "Lucida Sans Unicode", "Lucida Grande", "Lucida Sans", Arial, sans-serif;
}
#wrapper {
	text-align: left;
	margin: 0 auto 0;
	width: 95%;
	background-color: #ffffff;
}
#contents {
	position: relative;
	padding: 20px;
	border-left: 0px;
	border-right: 0px;
	border-top: 10px solid #e0e0e0;
	border-bottom: 10px solid #e0e0e0;
}
textarea.twopane {
	padding: 2px;
	border: 1px solid #b8b8b8;
	width: 95%;
	height: 26em;
}
table.twopane {
	border: 0px;
	width: 100%;
}
td.twopane {
	width: 50%;
}
input.solid {
	padding: 2px;
	border: 1px solid #b8b8b8;
	width: 95%;
}
input.blue {
	padding: 4px 10px;
	background-color: #248;
	color: #ffffff;
	border-style: none;
}
input.blue:hover {
    background-color: #24d;
}
textarea.scpane {
	padding: 2px;
	border: 1px solid #b8b8b8;
	width: 95%;
	height: 22em;
}
	</style>
	<script type="text/javascript">
<!--
//------------------------------------------------------------------------------
window.resizeTo(750, 600);    //  ウィンドウサイズ設定
//window.moveTo(50, 50);      //  ウィンドウ移動

var fso = new ActiveXObject("Scripting.FileSystemObject");

function exec_toRubyHash( str )
{
	var s = "";
	var lines = str.split("\r\n");
	for ( var i in lines ) {
		if ( lines[i].match(/^#define\s+([a-zA-Z0-9_]+)\s+([0-9xa-fA-F]+).*/) ) {
			s += "\t" + RegExp.$2 + " => \"" + RegExp.$1 + "\",\r\n";
		}
	}
	return s;
}

function exec_toJavascriptArray( str )
{
	var s = "";
	var lines = str.split("\r\n");
	for ( var i in lines ) {
		if ( lines[i].match(/^#define\s+([a-zA-Z0-9_]+)\s+([0-9xa-fA-F]+).*/) ) {
			s += "\t" + RegExp.$2 + ":\"" + RegExp.$1 + "\",\r\n";
		}
	}
	return s;
}

function exec_toCSV( str )
{
	var s = "";
	var lines = str.split("\r\n");
	for ( var i in lines ) {
		if ( lines[i].match(/^#define\s+([a-zA-Z0-9_]+)\s+([0-9xa-fA-F]+).*/) ) {
			s += "" + RegExp.$1 + ", " + RegExp.$2 + "\r\n";
		}
	}
	return s;
}

function onClickExec()
{
	var mode = "";
	var modeAry = document.getElementsByName("mode");
	for ( var i = 0; i < modeAry.length; i++ ) {
		if ( modeAry[i].checked ) {
			mode = modeAry[i].value;
		}
	}
	
	var p = document.getElementById("input").value;
	
	switch ( mode ) {
	case "AAA": var s = exec_toRubyHash(p); break;
	case "BBB": var s = exec_toJavascriptArray(p); break;
	case "CCC": var s = exec_toCSV(p); break;
	default: break;
	}
	document.getElementById("output").value = s;
}

function onClickClear()
{
	document.getElementById("input").value = "";
	document.getElementById("output").value = "";
}
//------------------------------------------------------------------------------
-->
	</script>
	<hta:application innerBorder="no" scroll="no"></hta:application>
</head>
<body>
 	<div id="wrapper"> 
		<div id="contents">
			<input type="radio" name="mode" value="AAA" checked>deine -> ruby 
			<input type="radio" name="mode" value="BBB">define -> jscript 
			<input type="radio" name="mode" value="CCC">define -> csv 
			<hr>
			<table class="twopane">
				<tr>
				<td class="twopane">
					input<br>
					<textarea class="twopane" id="input" wrap="off"></textarea>
				</td>
				<td class="twopane">
					output<br>
					<textarea class="twopane" id="output" wrap="off"></textarea>
				</td>
			</table>
			<br><br>
			<input type="button" class="blue" name="exec" value="exec" onclick="onClickExec()">
			<input type="button" class="blue" name="clear" value="clear" onclick="onClickClear()">
		</div>
	</div>
</body>
</html>
