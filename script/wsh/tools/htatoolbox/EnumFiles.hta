<!DOCTYPE html>
<html lang="ja">
<head>
	<meta http-equiv="Content-Style-Type" content="text/css" /> 
	<meta http-equiv="Content-Script-Type" content="text/javascript" /> 
	<meta http-equiv="Content-Type" content="text/html; charset=shift_jis" /> 
	<title>EnumFiles</title> 
	<style>
html,body {
	height: 100%;
	width: 100%;
	margin: 0;
	padding: 0;
	border: 0 none;
}
html {
	overflow-y: scroll;
}
body {
	background-color: #e0e0e0;
	font: normal 12px "メイリオ", Meiryo, "ヒラギノ角ゴ Pro W3", "Hiragino Kaku Gothic Pro", "Lucida Sans Unicode", "Lucida Grande", "Lucida Sans", Arial, sans-serif;
}
#wrapper {
	text-align: left;
	margin: 0 auto 0;
	width: 95%;
	background-color: #ffffff;
}
#contents {
	position: relative;
	padding: 20px;
	border-left: 0px;
	border-right: 0px;
	border-top: 10px solid #e0e0e0;
	border-bottom: 10px solid #e0e0e0;
}
textarea.twopane {
	padding: 2px;
	border: 1px solid #b8b8b8;
	width: 95%;
	height: 26em;
}
table.twopane {
	border: 0px;
	width: 100%;
}
td.twopane {
	width: 50%;
}
input.solid {
	padding: 2px;
	border: 1px solid #b8b8b8;
	width: 95%;
}
input.blue {
	padding: 4px 10px;
	background-color: #248;
	color: #ffffff;
	border-style: none;
}
input.blue:hover {
    background-color: #24d;
}
textarea.scpane {
	padding: 2px;
	border: 1px solid #b8b8b8;
	width: 95%;
	height: 22em;
}
	</style>
	<script type="text/javascript">
<!--
window.resizeTo(750, 600);    //  ウィンドウサイズ設定
//window.moveTo(50, 50);      //  ウィンドウ移動

var fso = new ActiveXObject("Scripting.FileSystemObject");

function enum_files( folderspec, recursive )
{
	var s = "";
	var d = fso.GetFolder(folderspec);
	var subdirs = new Enumerator(d.SubFolders);
	var files = new Enumerator(d.files);

	for ( ; !files.atEnd(); files.moveNext() ) {
		s += files.item().Name + "\n";
	}
	if ( recursive ) {
		for ( ; !subdirs.atEnd(); subdirs.moveNext() ) {
			s += enum_files(subdirs.item(), recursive);
		}
	}
	return s;
}
function enum_dirs( folderspec, recursive )
{
	var s = "";
	var d = fso.GetFolder(folderspec);
	var subdirs = new Enumerator(d.SubFolders);

	for ( ; !subdirs.atEnd(); subdirs.moveNext() ) {
		s += subdirs.item().Name + "\n";
		if ( recursive ) {
			s += enum_dirs(subdirs.item(), recursive);
		}
	}
	return s;
}
function enum_all_files( folderspec, recursive )
{
	var s = "";
	var d = fso.GetFolder(folderspec);
	var subdirs = new Enumerator(d.SubFolders);
	var files = new Enumerator(d.files);

	for ( ; !files.atEnd(); files.moveNext() ) {
		s += files.item().Name + "\n";
	}
	for ( ; !subdirs.atEnd(); subdirs.moveNext() ) {
		s += subdirs.item().Name + "\n";
		if ( recursive ) {
			s += enum_all_files(subdirs.item(), recursive);
		}
	}
	return s;
}

function onClickExec()
{
	var mode = "";
	var modeAry = document.getElementsByName("mode");
	for ( var i = 0; i < modeAry.length; i++ ) {
		if ( modeAry[i].checked ) {
			mode = modeAry[i].value;
		}
	}
	
	var p = document.getElementById("root").value;
	
	switch ( mode ) {
	case "File": var s = enum_files(p, false); break;
	case "Dir": var s = enum_dirs(p, false); break;
	case "All": var s = enum_all_files(p, false); break;
	case "FileR": var s = enum_files(p, true); break;
	case "DirR": var s = enum_dirs(p, true); break;
	case "AllR": var s = enum_all_files(p, true); break;
	default: break;
	}
	document.getElementById("output").value = s;
}

function onClickClear()
{
	document.getElementById("root").value = "";
	document.getElementById("output").value = "";
}
-->
	</script>
	<hta:application innerBorder="no" scroll="no"></hta:application>
</head>
<body>
 	<div id="wrapper"> 
		<div id="contents">
			<input type="radio" name="mode" value="File" checked>File 
			<input type="radio" name="mode" value="Dir">Directory 
			<input type="radio" name="mode" value="All">All 
			<input type="radio" name="mode" value="FileR">File(r) 
			<input type="radio" name="mode" value="DirR">Directory(r) 
			<input type="radio" name="mode" value="AllR">All(r) 
			<hr>
			<div>Path</div>
			<input type="text" class="solid" id="root" value="">
			<div>Files</div>
			<textarea class="scpane" id="output"></textarea>
			<br><br>
			<input type="button" class="blue" name="exec" value="exec" onclick="onClickExec()">
			<input type="button" class="blue" name="clear" value="clear" onclick="onClickClear()">
		</div>
	</div>
</body>
</html>
